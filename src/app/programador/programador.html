<div class="programador-page">
  <header class="programador-header">
    <div class="header-content">
      <div class="header-title">
        <h1>Mi Portafolio</h1>
      </div>

      <div class="header-actions">
        <div class="action-buttons">
          <button class="btn btn-secondary" (click)="goToInicio()">Inicio</button>
          <button class="btn btn-secondary" (click)="loadData()" title="Recargar datos">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="23 4 23 10 17 10"></polyline>
              <polyline points="1 20 1 14 7 14"></polyline>
              <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
            </svg>
            Recargar
          </button>
          <button 
            class="btn btn-notificaciones" 
            [class.has-notifications]="asesoriasPendientes.length > 0"
            (click)="toggleNotificaciones()"
            title="Ver notificaciones"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            Notificaciones
            @if (asesoriasPendientes.length > 0) {
              <span class="notification-count">{{ asesoriasPendientes.length }}</span>
            }
          </button>
          <button class="btn btn-primary" (click)="openModal()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="12" y1="5" x2="12" y2="19"></line>
              <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
            Agregar Proyecto
          </button>
        </div>
      </div>
    </div>
  </header>

  <div class="programador-content">
    @if (loading && !programador) {
      <div class="loading">
        <p>Cargando...</p>
      </div>
    } @else if (mostrarNotificaciones) {
      <!-- Vista de Notificaciones -->
      <div class="notificaciones-view">
        <div class="notificaciones-header">
          <h2>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            Notificaciones
            @if (asesoriasPendientes.length > 0) {
              <span class="badge-count">{{ asesoriasPendientes.length }}</span>
            }
          </h2>
        </div>

        @if (asesoriasPendientes.length > 0) {
          <div class="asesorias-list">
            @for (asesoria of asesoriasPendientes; track asesoria.id) {
              <div class="asesoria-card">
                <div class="asesoria-status">
                  <span class="status-badge status-pendiente">Pendiente</span>
                  <span class="fecha-solicitud">
                    {{ asesoria.fecha?.toDate().toLocaleDateString() }}
                  </span>
                </div>
                <div class="asesoria-header">
                  <div class="asesoria-main">
                    <h3>{{ asesoria.tema }}</h3>
                    <p class="asesoria-usuario">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                        <circle cx="12" cy="7" r="4"></circle>
                      </svg>
                      {{ asesoria.usuarioNombre }}
                    </p>
                    <p class="asesoria-email">{{ asesoria.usuarioEmail }}</p>
                  </div>
                </div>
                <div class="asesoria-details">
                  <div class="detail-item">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                      <line x1="16" y1="2" x2="16" y2="6"></line>
                      <line x1="8" y1="2" x2="8" y2="6"></line>
                      <line x1="3" y1="10" x2="21" y2="10"></line>
                    </svg>
                    <span><strong>Fecha solicitada:</strong> {{ asesoria.fechaSolicitada }}</span>
                  </div>
                  <div class="detail-item">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <circle cx="12" cy="12" r="10"></circle>
                      <polyline points="12 6 12 12 16 14"></polyline>
                    </svg>
                    <span><strong>Hora:</strong> {{ asesoria.horaSolicitada }}</span>
                  </div>
                </div>
                <div class="asesoria-content">
                  <p class="asesoria-descripcion">{{ asesoria.descripcion }}</p>
                  @if (asesoria.comentario) {
                    <p class="asesoria-comentario">
                      <strong>Comentario adicional:</strong> {{ asesoria.comentario }}
                    </p>
                  }
                </div>
                <div class="asesoria-actions">
                  <button class="btn btn-primary" (click)="aprobarAsesoria(asesoria)">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <polyline points="20 6 9 17 4 12"></polyline>
                    </svg>
                    Aprobar
                  </button>
                  <button class="btn btn-danger" (click)="openRechazarModal(asesoria)">
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="18"
                      height="18"
                      viewBox="0 0 24 24"
                      fill="none"
                      stroke="currentColor"
                      stroke-width="2"
                    >
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                    Rechazar
                  </button>
                </div>
              </div>
            }
          </div>
        } @else {
          <div class="empty-notificaciones">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="64"
              height="64"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
              <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
            </svg>
            <h3>Sin notificaciones</h3>
            <p>No tienes solicitudes de asesor√≠a pendientes en este momento</p>
          </div>
        }
      </div>
    } @else if (programador) {
      <div class="profile-section">
        <div class="profile-card">
          <div class="profile-left">
            @if (programador.photoURL) {
              <img
                [src]="programador.photoURL"
                [alt]="programador.displayName"
                class="profile-avatar"
              />
            } @else {
              <div class="profile-avatar-placeholder">
                {{ programador.displayName.charAt(0).toUpperCase() }}
              </div>
            }
            <div class="profile-info">
            <h2>{{ programador.displayName }}</h2>
            <p class="profile-email">{{ programador.email }}</p>
            @if (programador.especialidad) {
              <span class="profile-badge">{{ programador.especialidad }}</span>
            }
            
            <!-- Redes sociales -->
            @if (
              programador.redesSociales &&
              (programador.redesSociales.github || programador.redesSociales.linkedin)
            ) {
              <div class="profile-social">
                @if (programador.redesSociales.github) {
                  <a
                    [href]="programador.redesSociales.github"
                    target="_blank"
                    rel="noopener"
                    title="GitHub"
                    class="social-link"
                  >
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                      <path
                        d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
                      />
                    </svg>
                    GitHub
                  </a>
                }
                @if (programador.redesSociales.linkedin) {
                  <a
                    [href]="programador.redesSociales.linkedin"
                    target="_blank"
                    rel="noopener"
                    title="LinkedIn"
                    class="social-link"
                  >
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                      <path
                        d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"
                      />
                    </svg>
                    LinkedIn
                  </a>
                }
              </div>
            }
          </div>
          </div>
          
          <!-- Horarios de disponibilidad al lado derecho -->
          @if (programador.horariosDisponibles && programador.horariosDisponibles.length > 0) {
            <div class="profile-horarios">
              <h4>üìÖ Horarios de Disponibilidad</h4>
              <div class="horarios-list">
                @for (horario of programador.horariosDisponibles; track horario.dia) {
                  @if (horario.activo !== false && horario.horaInicio && horario.horaFin) {
                    <div class="horario-item">
                      <span class="horario-dia">{{ getDiaNombre(horario.dia) }}</span>
                      <span class="horario-horas">{{ horario.horaInicio }} - {{ horario.horaFin }}</span>
                    </div>
                  }
                }
              </div>
            </div>
          }
        </div>
      </div>

      <!-- Proyectos Section -->
      <div class="proyectos-section">
        <h2>Mis Proyectos ({{ proyectos.length }})</h2>

        @if (proyectos.length === 0) {
          <div class="empty-state">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="64"
              height="64"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
              <polyline points="14 2 14 8 20 8"></polyline>
            </svg>
            <h3>No tienes proyectos a√∫n</h3>
            <p>Agrega tu primer proyecto para comenzar a construir tu portafolio</p>
          </div>
        } @else {
          <div class="proyectos-grid">
            @for (proyecto of proyectos; track proyecto.id) {
              <div class="proyecto-card">
                @if (proyecto.imagenes && proyecto.imagenes.length > 0) {
                  <div class="proyecto-image">
                    <img [src]="proyecto.imagenes[0]" [alt]="proyecto.nombre" />
                  </div>
                }

                <div class="proyecto-body">
                  <div class="proyecto-header">
                    <h3>{{ proyecto.nombre }}</h3>
                    <span class="proyecto-tipo" [class]="'tipo-' + proyecto.tipo">
                      {{ proyecto.tipo }}
                    </span>
                  </div>

                  <p class="proyecto-descripcion">{{ proyecto.descripcion }}</p>

                  @if (proyecto.participacion && proyecto.participacion.length > 0) {
                    <div class="proyecto-participacion">
                      <strong>Participaci√≥n:</strong>
                      <div class="tags">
                        @for (part of proyecto.participacion; track part) {
                          <span class="tag tag-participacion">{{ part }}</span>
                        }
                      </div>
                    </div>
                  }

                  @if (proyecto.tecnologias && proyecto.tecnologias.length > 0) {
                    <div class="proyecto-tecnologias">
                      <strong>Tecnolog√≠as:</strong>
                      <div class="tags">
                        @for (tech of proyecto.tecnologias.slice(0, 5); track tech) {
                          <span class="tag tag-tech">{{ tech }}</span>
                        }
                      </div>
                    </div>
                  }

                  <div class="proyecto-links">
                    @if (proyecto.repositorio) {
                      <a
                        [href]="proyecto.repositorio"
                        target="_blank"
                        rel="noopener"
                        class="proyecto-link"
                      >
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                          <path
                            d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"
                          />
                        </svg>
                        Repositorio
                      </a>
                    }
                    @if (proyecto.demo) {
                      <a
                        [href]="proyecto.demo"
                        target="_blank"
                        rel="noopener"
                        class="proyecto-link"
                      >
                        <svg
                          width="18"
                          height="18"
                          viewBox="0 0 24 24"
                          fill="none"
                          stroke="currentColor"
                          stroke-width="2"
                        >
                          <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path>
                          <polyline points="15 3 21 3 21 9"></polyline>
                          <line x1="10" y1="14" x2="21" y2="3"></line>
                        </svg>
                        Demo
                      </a>
                    }
                  </div>

                  <div class="proyecto-actions">
                    <button class="btn-icon btn-edit" (click)="openModal(proyecto)" title="Editar">
                      <svg
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
                      </svg>
                    </button>
                    <button
                      class="btn-icon btn-delete"
                      (click)="eliminarProyecto(proyecto.id!)"
                      title="Eliminar"
                    >
                      <svg
                        width="18"
                        height="18"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                      >
                        <polyline points="3 6 5 6 21 6"></polyline>
                        <path
                          d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"
                        ></path>
                      </svg>
                    </button>
                  </div>
                </div>
              </div>
            }
          </div>
        }
      </div>
    }
  </div>

  <!-- Modal de Proyecto -->
  @if (showModal) {
    <div class="modal-overlay" (click)="closeModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>{{ selectedProyecto ? 'Editar' : 'Agregar' }} Proyecto</h2>
          <button class="btn-close" (click)="closeModal()">
            <svg
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <form class="modal-form" (ngSubmit)="guardarProyecto()">
          <div class="form-group">
            <label>Nombre del Proyecto *</label>
            <input type="text" [(ngModel)]="formData.nombre" name="nombre" required />
          </div>

          <div class="form-group">
            <label>Descripci√≥n *</label>
            <textarea
              [(ngModel)]="formData.descripcion"
              name="descripcion"
              rows="4"
              required
            ></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label>Tipo *</label>
              <select [(ngModel)]="formData.tipo" name="tipo" required>
                <option value="academico">Acad√©mico</option>
                <option value="laboral">Laboral</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label>Participaci√≥n</label>
            <div class="checkbox-group">
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="formData.participacion?.includes('frontend')"
                  (change)="toggleParticipacion('frontend')"
                />
                Frontend
              </label>
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="formData.participacion?.includes('backend')"
                  (change)="toggleParticipacion('backend')"
                />
                Backend
              </label>
              <label class="checkbox-label">
                <input
                  type="checkbox"
                  [checked]="formData.participacion?.includes('base-datos')"
                  (change)="toggleParticipacion('base-datos')"
                />
                Base de Datos
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Tecnolog√≠as</label>
            <div class="input-with-button">
              <input
                type="text"
                [(ngModel)]="tecnologiaInput"
                name="tecnologiaInput"
                placeholder="Angular, Firebase, etc."
              />
              <button type="button" class="btn-add" (click)="agregarTecnologia()">Agregar</button>
            </div>
            @if (formData.tecnologias && formData.tecnologias.length > 0) {
              <div class="tags-list">
                @for (tech of formData.tecnologias; track tech; let i = $index) {
                  <span class="tag-removable">
                    {{ tech }}
                    <button type="button" (click)="eliminarTecnologia(i)">√ó</button>
                  </span>
                }
              </div>
            }
          </div>

          <div class="form-group">
            <label>URL Repositorio</label>
            <input
              type="url"
              [(ngModel)]="formData.repositorio"
              name="repositorio"
              placeholder="https://github.com/..."
            />
          </div>

          <div class="form-group">
            <label>URL Demo</label>
            <input type="url" [(ngModel)]="formData.demo" name="demo" placeholder="https://..." />
          </div>

          <div class="form-group">
            <label>Im√°genes (URLs)</label>
            <div class="input-with-button">
              <input
                type="url"
                [(ngModel)]="imagenInput"
                name="imagenInput"
                placeholder="https://..."
              />
              <button type="button" class="btn-add" (click)="agregarImagen()">Agregar</button>
            </div>
            @if (formData.imagenes && formData.imagenes.length > 0) {
              <div class="images-list">
                @for (img of formData.imagenes; track img; let i = $index) {
                  <div class="image-preview">
                    <img [src]="img" alt="Preview" />
                    <button type="button" class="btn-remove-image" (click)="eliminarImagen(i)">
                      √ó
                    </button>
                  </div>
                }
              </div>
            }
          </div>

          <div class="modal-actions">
            <button type="button" class="btn btn-secondary" (click)="closeModal()">Cancelar</button>
            <button type="submit" class="btn btn-primary" [disabled]="loading">
              {{ loading ? 'Guardando...' : 'Guardar Proyecto' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  }

  <!-- Modal Responder Asesor√≠a -->
  @if (showAsesoriaModal && selectedAsesoria) {
    <div class="modal-overlay" (click)="closeAsesoriaModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>Responder Solicitud</h2>
          <button class="btn-close" (click)="closeAsesoriaModal()">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <line x1="18" y1="6" x2="6" y2="18"></line>
              <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
          </button>
        </div>

        <form class="modal-form" (ngSubmit)="responderAsesoria()" #respuestaFormRef="ngForm">
          <div class="asesoria-detalle">
            <div class="detalle-item">
              <strong>Solicitante:</strong>
              <p>{{ selectedAsesoria.usuarioNombre }} ({{ selectedAsesoria.usuarioEmail }})</p>
            </div>
            <div class="detalle-item">
              <strong>Fecha y Hora Solicitada:</strong>
              <p class="fecha-hora-destacada">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="18"
                  height="18"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <circle cx="12" cy="12" r="10"></circle>
                  <polyline points="12 6 12 12 16 14"></polyline>
                </svg>
                {{ selectedAsesoria.fechaSolicitada }} a las {{ selectedAsesoria.horaSolicitada }}
              </p>
            </div>
            <div class="detalle-item">
              <strong>Tema:</strong>
              <p>{{ selectedAsesoria.tema }}</p>
            </div>
            <div class="detalle-item">
              <strong>Descripci√≥n:</strong>
              <p>{{ selectedAsesoria.descripcion }}</p>
            </div>
            @if (selectedAsesoria.comentario) {
              <div class="detalle-item">
                <strong>Comentario Adicional:</strong>
                <p>{{ selectedAsesoria.comentario }}</p>
              </div>
            }
          </div>

          <div class="form-group">
            <label>Acci√≥n *</label>
            <div class="radio-group">
              <label class="radio-label">
                <input
                  type="radio"
                  [(ngModel)]="respuestaForm.accion"
                  name="accion"
                  value="aprobar"
                />
                <span>‚úì Aprobar</span>
              </label>
              <label class="radio-label">
                <input
                  type="radio"
                  [(ngModel)]="respuestaForm.accion"
                  name="accion"
                  value="rechazar"
                />
                <span>‚úó Rechazar</span>
              </label>
            </div>
          </div>

          <div class="form-group">
            <label>Mensaje de Respuesta *</label>
            <textarea
              [(ngModel)]="respuestaForm.respuesta"
              name="respuesta"
              placeholder="Escribe tu respuesta al usuario..."
              required
              rows="5"
              maxlength="500"
            ></textarea>
            <small>{{ respuestaForm.respuesta.length }}/500 caracteres</small>
          </div>

          <div class="modal-actions">
            <button
              type="button"
              class="btn btn-secondary"
              (click)="closeAsesoriaModal()"
              [disabled]="respondiendo"
            >
              Cancelar
            </button>
            <button
              type="submit"
              class="btn btn-primary"
              [disabled]="!respuestaFormRef.form.valid || respondiendo"
            >
              {{ respondiendo ? 'Enviando...' : 'Enviar Respuesta' }}
            </button>
          </div>
        </form>
      </div>
    </div>
  }

  <!-- Modal Rechazar Asesor√≠a -->
  @if (showRechazarModal && selectedAsesoria) {
    <div class="modal" (click)="closeRechazarModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <div class="modal-header">
          <h2>Rechazar Solicitud de Asesor√≠a</h2>
          <button type="button" class="btn-close" (click)="closeRechazarModal()">&times;</button>
        </div>

        <div class="modal-body">
          <div class="asesoria-info-summary">
            <h3>{{ selectedAsesoria.tema }}</h3>
            <p><strong>Solicitante:</strong> {{ selectedAsesoria.usuarioNombre }}</p>
            <p>
              <strong>Fecha y hora:</strong> {{ selectedAsesoria.fechaSolicitada }} a las
              {{ selectedAsesoria.horaSolicitada }}
            </p>
          </div>

          <form #rechazarFormRef="ngForm" (ngSubmit)="rechazarAsesoria()">
            <div class="form-group">
              <label for="motivoRechazo">Motivo del Rechazo *</label>
              <textarea
                id="motivoRechazo"
                [(ngModel)]="motivoRechazo"
                name="motivoRechazo"
                placeholder="Explica el motivo por el cual no puedes atender esta solicitud..."
                required
                rows="5"
                maxlength="500"
                class="form-control"
              ></textarea>
              <small>{{ motivoRechazo.length }}/500 caracteres</small>
            </div>

            <div class="modal-actions">
              <button
                type="button"
                class="btn btn-secondary"
                (click)="closeRechazarModal()"
                [disabled]="respondiendo"
              >
                Cancelar
              </button>
              <button
                type="submit"
                class="btn btn-danger"
                [disabled]="!rechazarFormRef.form.valid || respondiendo"
              >
                {{ respondiendo ? 'Rechazando...' : 'Confirmar Rechazo' }}
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  }
</div>

